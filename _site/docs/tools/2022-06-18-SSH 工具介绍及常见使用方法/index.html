<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>SSH 工具介绍及常见使用方法 | Echo</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="SSH 工具介绍及常见使用方法" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Jekyll theme for documentation" /><meta property="og:description" content="A Jekyll theme for documentation" /><link rel="canonical" href="https://zipgao.github.io/docs/tools/2022-06-18-SSH%20%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" /><meta property="og:url" content="https://zipgao.github.io/docs/tools/2022-06-18-SSH%20%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" /><meta property="og:site_name" content="Echo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-31T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SSH 工具介绍及常见使用方法" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-05-31T00:00:00+08:00","datePublished":"2020-05-31T00:00:00+08:00","description":"A Jekyll theme for documentation","headline":"SSH 工具介绍及常见使用方法","mainEntityOfPage":{"@type":"WebPage","@id":"https://zipgao.github.io/docs/tools/2022-06-18-SSH%20%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"},"url":"https://zipgao.github.io/docs/tools/2022-06-18-SSH%20%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="https://zipgao.github.io/" class="site-title lh-tight"> Echo </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="https://zipgao.github.io/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://zipgao.github.io/docs/tools" class="nav-list-link">Tools</a><ul class="nav-list "><li class="nav-list-item "><a href="https://zipgao.github.io/docs/tools/2022-06-18-SSH%20%E9%85%8D%E7%BD%AE%E5%85%AC%E9%92%A5%E7%99%BB%E5%BD%95/" class="nav-list-link">SSH 配置公钥登录</a><li class="nav-list-item "><a href="https://zipgao.github.io/docs/tools/2022-06-18-%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%8C%E9%87%8D%E8%AE%A4%E8%AF%81%E4%BB%A5%E5%8F%8A%E5%85%AC%E9%92%A5%E8%AE%A4%E8%AF%81%E7%99%BB%E5%BD%95/" class="nav-list-link">社交组服务器双重认证设置</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://zipgao.github.io/docs/research" class="nav-list-link">Research</a><ul class="nav-list "></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://zipgao.github.io/docs/python" class="nav-list-link">Python</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://zipgao.github.io/docs/Python/pandas/pandas/" class="nav-list-link">Pandas</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://zipgao.github.io/docs/Python/pandas/2022-05-31-Pandas%E4%BB%8EPython%20dict%E4%B8%AD%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95/" class="nav-list-link">Pandas 从Python dict中加载数据</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://zipgao.github.io/docs/Python/Python%20codebase/python%20codebase/" class="nav-list-link">Python codebase</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://zipgao.github.io/docs/Python/Python%20codebase/Python%20Google%20style%20comment/" class="nav-list-link">Python Google style comment</a><li class="nav-list-item "> <a href="https://zipgao.github.io/docs/Python/Python%20codebase/python%E5%A4%9A%E8%BF%9B%E7%A8%8B/" class="nav-list-link">Python 多进程</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://zipgao.github.io/docs/Python/pytorch/pytorch/" class="nav-list-link">Pytorch</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://zipgao.github.io/docs/Python/pytorch/Pytorch%20%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E5%90%88%E9%9B%86/" class="nav-list-link">PyTorch常用代码段</a></ul></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Echo" aria-label="Search Echo" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://github.com/ZipGao/" class="site-button" > GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="">Python 多线程</a><li class="breadcrumb-nav-list-item"><span>SSH 工具介绍及常见使用方法</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 id="ssh-工具介绍及常见使用方法"> <a href="#ssh-工具介绍及常见使用方法" class="anchor-heading" aria-labelledby="ssh-工具介绍及常见使用方法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSH 工具介绍及常见使用方法</h1><h2 id="ssh介绍"> <a href="#ssh介绍" class="anchor-heading" aria-labelledby="ssh介绍"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSH介绍</h2><p>SSH 为 Secure Shell 的缩写。 SSH是一种网络协议，用于计算机之间的加密登录。如果一个用户从本地计算机，使用SSH协议登录另一台远程计算机，我们就可以认为，这种登录是安全的，即使被中途截获，密码也不会泄露。 SSH主要用于远程登录。假定你要以用户名user，登录远程主机host，只要一条简单命令就可以了。</p><h2 id="常见使用方法"> <a href="#常见使用方法" class="anchor-heading" aria-labelledby="常见使用方法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 常见使用方法</h2><h3 id="进行远程登录"> <a href="#进行远程登录" class="anchor-heading" aria-labelledby="进行远程登录"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 进行远程登录</h3><ol><li><code class="language-plaintext highlighter-rouge">ssh user@host</code>：最简单的远程登录方法，默认对目标主机22端口建立连接<li><code class="language-plaintext highlighter-rouge">ssh user@host -p portnumber</code>：指定目标主机的连接端口 第一次登录会产生如下系统提示：<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ ssh user@host
 The authenticity of host ‘host (12.18.429.21)’ can’t be established.
 RSA key fingerprint is 98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d.
 Are you sure you want to continue connecting (yes/no)?
</code></pre></div></div><p>输入<code class="language-plaintext highlighter-rouge">yes</code>并且输入登录密码之后，本地便将目标主机的公钥保存在<code class="language-plaintext highlighter-rouge">user/.ssh/known_host</code>文件之中，下次登录就可以省去此步警告，直接输入密码登录</p><li><p>公钥登录方法<br /> 参考: [[2022-06-18-SSH 配置公钥登录]]</p><p>使用密码登录，每次都必须输入密码，非常麻烦。好在SSH还提供了公钥登录，可以省去输入密码的步骤。 所谓”公钥登录”，原理很简单，就是用户将自己的公钥储存在远程主机上。登录的时候，远程主机会向用户发送一段随机字符串，用户用自己的私钥加密后，再发回来。远程主机用事先储存的公钥进行解密，如果成功，就证明用户是可信的，直接允许登录shell，不再要求密码。 这种方法要求用户必须提供自己的公钥。如果没有现成的，可以直接用ssh-keygen生成一个：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ssh-keygen
</code></pre></div></div><p>运行上面的命令以后，系统会出现一系列提示，可以一路回车。其中有一个问题是，要不要对私钥设置口令（passphrase），如果担心私钥的安全，这里可以设置一个。</p><p>运行结束以后，在<code class="language-plaintext highlighter-rouge">$HOME/.ssh/</code>目录下，会新生成两个文件：<code class="language-plaintext highlighter-rouge">id_rsa.pub</code>和<code class="language-plaintext highlighter-rouge">id_rsa</code>。前者是公钥，后者是私钥。</p><p>这时再输入下面的命令，将公钥传送到远程主机host上面：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ ssh-copy-id user@host
</code></pre></div></div><p>上述命令只是传输公钥的一种方法，当然也可以使用其他的方法进行文件传输，如SCP以及命令行工具（Xshell，MOBAXtreme等）自带的工具进行秘钥的传输。从此再登录，就不需要输入密码了。 如果还是不行，就打开远程主机的/etc/ssh/sshd_config这个文件，检查下面几行前面”#”注释是否取掉。</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> RSAAuthentication yes  
 PubkeyAuthentication yes  
 AuthorizedKeysFile .ssh/authorized_keys
</code></pre></div></div><p>然后，重启远程主机的ssh服务。</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> // ubuntu系统  
 service ssh restart
 // debian系统  
 /etc/init.d/ssh restart
</code></pre></div></div></ol><h3 id="远程操作与端口转发"> <a href="#远程操作与端口转发" class="anchor-heading" aria-labelledby="远程操作与端口转发"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 远程操作与端口转发</h3><ol><li>简单的命令的执行： 通常对远程主机的操作可以直接通过SSH远程登录进行操作，有时命令较少时可以直接使用SSH命令在远程主机上执行命令，如<code class="language-plaintext highlighter-rouge">ssh -user@host -p port 'ls' </code>表示在远程主机上执行<code class="language-plaintext highlighter-rouge">ls</code>命令。<li><p>本地端口转发 假定host1是本地主机，host2是远程主机。由于种种原因，这两台主机之间无法连通（防火墙等等）。但是，另外还有一台host3，可以同时连通前面两台主机。因此，很自然的想法就是，通过host3，将host1连上host2。在host1上执行下面命令即可：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ssh -L 1111:host2:2222 host3  命令中的L参数一共接受三个值，分别是”本地端口:目标主机:目标主机端口”，它们之间用冒号分隔。这条命令的意思，就是指定SSH绑定本地端口1111，然后指定host3将所有的数据，转发到目标主机host2的2222端口。  这样一来，我们只要连接host1的2121端口，就等于连上了host2的21端口。  “本地端口转发”使得host1和host3之间仿佛形成一个数据传输的秘密隧道，因此又被称为”SSH隧道”。  下面是一个比较有趣的例子。

 ssh -L 5900:localhost:5900 host3
</code></pre></div></div><p>它表示将本机的5900端口绑定host3的5900端口（这里的localhost指的是host3，因为目标主机是相对host3而言的，也就是在host3上的localhost）。 另一个例子是通过host3的端口转发，ssh登录host2。</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ssh -L 9001:host2:22 host3
</code></pre></div></div><p>这时，只要ssh登录本机的9001端口，就相当于登录host2了。</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ssh -p 9001 localhost
</code></pre></div></div><p>上面的-p参数表示指定登录端口。 通过跳板机host2的port2端口在本地host1的port1端口运行远端服务器host3的port3端口上的jupyter notebook服务：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ssh -N -L port1:localhost:port3 user@host2 -p port2
</code></pre></div></div><p>从上面的命令中可以看出，<code class="language-plaintext highlighter-rouge">-L</code>之后的命令可以理解是在host3上执行的。</p><li><p>远程端口转发 既然”本地端口转发”是指绑定本地端口的转发，那么”远程端口转发”（remote forwarding）当然是指绑定远程端口的转发。</p><p>还是接着看上面那个例子，host1与host2之间无法连通，必须借助host3转发。但是，特殊情况出现了，host3是一台内网机器，它可以连接外网的host1，但是反过来就不行，外网的host1连不上内网的host3。这时，”本地端口转发”就不能用了，怎么办？</p><p>解决办法是，既然host3可以连host1，那么就从host3上建立与host1的SSH连接，然后在host1上使用这条连接就可以了。</p><p>我们在host3执行下面的命令：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ssh -R 2121:host2:21 host1
</code></pre></div></div><p>R参数也是接受三个值，分别是”远程主机端口:目标主机:目标主机端口”。这条命令的意思，就是让host1监听它自己的2121端口，然后将所有数据经由host3，转发到host2的21端口。由于对于host3来说，host1是远程主机，所以这种情况就被称为”远程端口绑定”。 绑定之后，我们在host1就可以连接host2了：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ ftp localhost:2121
</code></pre></div></div><p>这里必须指出，”远程端口转发”的前提条件是，host1和host3两台主机都有sshD和ssh客户端。</p></ol><p>参考资料： <a href="https://www.tianqiweiqi.com/ssh-study.html">## SSH原理与使用教程</a></p><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Patrick Marsceill. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/tree/main/LICENSE.txt">MIT license.</a> <a href="https://www.netlify.com/">This site is powered by Netlify.</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/ZipGao//tree/main/docs/tools/2022-06-18-SSH 工具介绍及常见使用方法.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
